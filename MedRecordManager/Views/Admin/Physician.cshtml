@model PhysicianVm
@{
    ViewData["Title"] = "Set Up Physican";
}

@section scripts{
    <script type="text/javascript">

        $(document).on('click', '.deletePh', function () {
            var pvid = $(this).parent().parent().find('.primaryId').text()
            $.ajax({
                url: '/admin/deletePhyisican',
                type: 'post',
                data: {
                    pvPhysicianId: parseInt(pvid, 10),
                    officeKey: $('#ddlOfficeKey').val()
                }
            }).done(function (response) {
                $('#results').html(response);
                $('#addNew').html('');
            });
        });

        $(document).on('click', '.editPh', function () {
            var pvid = $(this).parent().parent().find('.primaryId').text()
            $.ajax({
                url: '/admin/editPhyisican',
                type: 'post',
                data: {
                    pvPhysicianId: parseInt(pvid, 10),
                    officeKey: $('#ddlOfficeKey').val()
                }
            }).done(function (response) {
                $('#results').html(response);
                $('#addNew').html('');
            });
        });

        function addPhysician() {
            $.ajax({
                url: '/admin/addPhysician',
                type: 'post',
                data: { officeKey: $('#ddlOfficeKey').val() }
            }).done(function (response) {
                $('#addNew').html(response);
                $('#results').html('');
                
            });
        };


        function mappedPhysician() {
            $.ajax({
                url: '/admin/getMapedPh',
                type: 'get',
                data: { officeKey: $('#ddlOfficeKey').val() }
            }).done(function (response) {
                $('#results').html(response);
                $('#addNew').html('');
            });
        };

       

        function onSuccess(context) {
            $('#results').html(context);
            $('#addNew').html('');
        };

        $(document).ready(function () {
            $('#ddlOfficeKey').change(function () {
                mappedPhysician();
                $('#addNewButton').show();
            });
      
        });
    </script>

}
    <div class="row top-buffer">
        <div class="box box-widget">
            <div class="box-header with-border">
                <h3 class="box-title">Physician</h3>
            </div>
            <div class="box-body">
                <form asp-action="SavePhysician" asp-controller="Admin" data-ajax="true" data-ajax-method="POST" data-ajax-complete="onComplete" data-ajax-success="onSuccess">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label asp-for="Inputs.OfficeKey" class="control-label">Office Key:</label>
                                <select class="form-control" asp-for="Inputs.OfficeKey" , asp-items="@Model.Inputs.OfficeKeys" id="ddlOfficeKey"></select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <div class="control-group">
                                    <div style="margin-top: 24px;">
                                        <input type="button" value="Add New" class="btn btn-primary" id="addNewButton" style="display:none" onclick="addPhysician()" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="addNew">
                    </div>
                </form>
            </div>
        </div>
    </div>

   
    <div id="results"></div>
  


